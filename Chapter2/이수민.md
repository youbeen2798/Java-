# 메서드 메모리에 저장
![image](https://user-images.githubusercontent.com/58407737/221530588-e3ba8dbc-44cc-48cd-b07d-89c83934fdfa.png)

</br>

JVM이 개발자가 작성한 모든 클래스와 임포트 패키지 역시 스태틱 영역에 가져다 놓는다. </br>
그래서 스태틱 영역을 클래스들의 놀이터라한다.

- 중괄호로 인해 스택 쌓이고 제거된다. (main() 메서드 스택 프레임에서 중괄호를 만나면 모든 프로그램 종료된다.)
- if 블록 스택 프래임도 존재한다는 것!!
- 변수가 블록 스택 프레임에 저장이 되는데 제거가 된 후 제거가 되었던 변수를 사용하게 된다면 컴피일러가 오류라며 컴파일을 거부하게 된다.

</br>

변수는 메모리에 저장되어 지역 변수, 클래스 멤버 변수, 객체 멤버 변수 즉, 목적마다 다르게 힙, 스택, 스태틱 영역에 저장되어 있다. </br>

- 지역 변수:  stack 영역 / 스택 프래임
- 클래스 멤버 변수: static 영역/ static 영역에 자리잡히면 JVM이 종료될 때까지 고정된(static) 상태로 그자리에 있는다.
- 객체맴버 변수: 힙 영역
(객체 멤버변수들은 객체와 함께 가비지 컬렉터라고 하는 힙 메모리 회수기에 의해 제거된다.)

</br>

**외부 블록에서 내부 블록의 변수에는 접근할 수 없지만, 내부 블록에서 외부 블록의 변수에 접근하는 것은 가능하다!!!** </br>
**= 외부 스택 프레임에서 내부 스택 프레임의 변수에 접근하는 것은 불가능하나 그 역은 가능한다.**

</br>

## 같은 메모리안에 존재하는 메서드끼리 지역 변수를 참조할 수 없게 만든 이유?

1. 메서드는 서로의 고유 공간인데, 서로 침범하면 무단 침입으로 자바 월드에 문제를 유발할 수 있기 때문에
2. 포인터 문제
if, 지역변수 m에 접근한다고 하면 m의 위치를 명확하게 알아야 하는데, m 변수의 메모리 위치 즉 포인터(메모리 주소값)을 알아야한다. 자바는 포인터가 없다. 

</br>

### 즉, 포인터를 사용할 수 없으므로메서드 스택 프레임 사이에 변수를 참조하는 것은 불가능하다.

</br>
스택 메모리 내의 스택 프레임 안의 변수를 지역 변수라고 한다. </br>

메서드를 호출할 때마다 해당 메서드 스택 프레임이 생긴다. </br>

메서드를 호출하면서 인자로 전달되는 것은 변수 자체가 아니라 변수가 저장한 값만을 복제해서 전달한다. → **Call By Value (값에 의한 호출)** </br>

메서드 사이에 값을 전달하거나 반환하는 방법은 메서드의 인자와 반환값으로만 가능하다. (return으로) </br>

**⇒ 되도록이면 전역변수는 사용하지 않는게 좋다.**

</br>

# 전역 변수를 사용해야하지 말아야하는 이유?
### 두 메서드간 값을 전달하는 방법

1. 메서드 인자를 넘겨준다. → private static void passValue(int a, int b) 
2. 메서드를 종료할 때 반환값을 넘겨준다. → return a+b
3. 전역변수 사용

</br>

**Static이 붙어 있으면** 
T 메모리의 스태틱 영역에 변수 공간이 할당된다. 

지역 변수: 스택프레임에 종속적임

전역 변수: 스택프레임에 독립적임

</br>

### **정말 사용하지 말아야하는 이유?**

- 프로젝트 규모에 따라 코드가 커지면서 여러 메서드에서 전역 변수의 값을 변경하기 시작하면 T 메모리로 추적하지 않는 이상 전역 변수에 저장돼 있는 값을 파악하기 쉽지 않음 

→ 규모가 커지면 코드량도 많아지기 때문에 전역변수를 이용해 값을 변경한다면 어떤 값이 들어가있는지 헷갈릴 수도 있고 까먹을 수 도 있음 또한, 값을 찾으려면 추적해야함 (상당히 까다로움) 그래서  피하자!!!!!!
- but, 읽기 전용으로 값을 공유해서 전역 상수로 사용하는건 권장한다.
→ ex) 값이 정해져 있는 PI 값

- 멀티 스레드에서는 문제가 심각하다.

</br>

# 멀티 스레드/ 멀티 프로세스를 이해하자!

### 1. 멀티 스레드는 스택 영역을 스레드 개수만큼 분할해서 쓰는 것이다. </br>
  
  ![image](https://user-images.githubusercontent.com/58407737/221532379-637d2889-c6ed-4867-974f-1aa12d337c0c.png) </br>
  
### 2. 멀티 프로세서는 다수의 데이터 저장 영역, 다수의 메소리를 갖는 구조이다. </br>
  
  ![image](https://user-images.githubusercontent.com/58407737/221532548-7947d8ae-e93a-45aa-8b3d-889f3b5e5884.png) </br>

 멀티 프로세스는 각 프로세스마다 각자의 T 메모리가 있고 각자 고유의 공간이므로 서로 참조할 수 없다. </br> 
 멀티 스레드는 하나의 T 메모리만 사용하는데 스택 영역만 분할해서 사용하는 구조다. </br>

 멀티 프로세스는 하나의 프로세스가 다른 프로세스의 T 메모리 영역을 절대 침범할 수 없는 메모리 안전한 구조이지만 메모리 사용량은 크다. </br>

 멀티 스레드는 하나의 T 메모리 안에서 스택 영역만 분할한 것이기 때문에 하나의 스레드에서 다른 스레드의 스택 영역에는 접근할 수 없지만 스태틱 영역과 힙 영역은 공유해서 사용하는 구조다. </br>

 따라서 멀티 프로세스 대비 메모리 적게 사용할 수 있는 구조다. </br>

</br>

# 멀티 스레드에서 전역변수 사용의 문제점

스레드의 안정성이 깨진다. 이를 보완하기 위해 락을 거는 방법이 있지만, 락을 거는 순간 멀티 스레드의 장점은 사라진것과 같다. </br>

## **객체 지향의 용어**

- 필드: 지역

- 속성: 프로퍼티

- 함수: 펑션

- 메서드: 방법

**같은 일을 하지만 이름을 차별화 하자!** </br>


### **절차/구조적 프로그래밍**

- 공유 변수: 필드

- 기능적 요소: 함수

</br>



### **객체 지향 프로그래밍** 

- 전역 변수: 프로퍼티

- 함수: 메서드

## 객체 지향을 알려면 절차적/구조적 프로그래밍도 잘 알기

### 정리

힙영역을 사용하는 것이 기존의 절차적/구조적 언어와 차이가 있다. </br>

스태틱: 클래스 상주 </br>

스택: 메서드 상주 </br>

힙: 객체 상주 </br>

